<UserControl x:Class="AeroFleetManagerPro.Views.PlanningView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             xmlns:converters="clr-namespace:AeroFleetManagerPro.Converters"
             mc:Ignorable="d">
    
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <DockPanel Grid.Row="0" Margin="0,0,0,20">
            <TextBlock Text="ÐŸÐ»Ð°Ð½ÑƒÐ²Ð°Ð½Ð½Ñ Ñ€ÐµÐ¹ÑÑ–Ð²" 
                     FontSize="28" 
                     FontWeight="Bold" 
                     VerticalAlignment="Center"
                     Foreground="#2196F3"/>
            
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                <Button Style="{StaticResource PrimaryButton}"
                      Command="{Binding AddFlightCommand}"
                      Margin="5">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="+" Margin="0,0,5,0"/>
                        <TextBlock Text="Ð”Ð¾Ð´Ð°Ñ‚Ð¸ Ñ€ÐµÐ¹Ñ"/>
                    </StackPanel>
                </Button>
                
            </StackPanel>
        </DockPanel>

        <Border Grid.Row="1" Padding="15" Margin="0,0,0,15">
            <StackPanel>
                <TextBlock Text="Ð”Ð°Ñ‚Ð° Ñ€Ð¾Ð·ÐºÐ»Ð°Ð´Ñƒ" FontWeight="Medium" Margin="0,0,0,10"/>
                <DatePicker SelectedDate="{Binding SelectedDate, Mode=TwoWay}"
                          Width="200"
                          HorizontalAlignment="Left"/>
            </StackPanel>
        </Border>

        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Border Grid.Column="0" Margin="0,0,10,0">
                <DockPanel>
                    <StackPanel DockPanel.Dock="Top" Margin="20,20,20,15">
                        <TextBlock Text="Ð Ð¾Ð·ÐºÐ»Ð°Ð´ Ñ€ÐµÐ¹ÑÑ–Ð²" 
                                 FontSize="18" 
                                 FontWeight="Medium"/>
                        <TextBlock Text="{Binding SelectedDate, StringFormat='Ð Ð¾Ð·ÐºÐ»Ð°Ð´ Ð½Ð° {0:dddd, dd MMMM yyyy}'}"
                                 Foreground="Gray"
                                 Margin="0,5,0,0"/>
                    </StackPanel>
                    
                    <ProgressBar DockPanel.Dock="Top"
                               IsIndeterminate="True"
                               Visibility="{Binding IsLoading, Converter={StaticResource BoolToVisibilityConverter}}"
                               Margin="20,0,20,15"/>
                    
                    <DataGrid ItemsSource="{Binding FlightSchedules}"
                            SelectedItem="{Binding SelectedFlight}"
                            AutoGenerateColumns="False"
                            IsReadOnly="True"
                            GridLinesVisibility="Horizontal"
                            HeadersVisibility="Column"
                            Margin="20,0,20,20">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Ð ÐµÐ¹Ñ â„–" 
                                              Binding="{Binding FlightNumber}" 
                                              Width="80"/>
                            <DataGridTextColumn Header="Ð›Ñ–Ñ‚Ð°Ðº" 
                                              Binding="{Binding Aircraft.RegistrationNumber}" 
                                              Width="100"/>
                            <DataGridTextColumn Header="ÐœÐ°Ñ€ÑˆÑ€ÑƒÑ‚" Width="150">
                                <DataGridTextColumn.Binding>
                                    <MultiBinding StringFormat="{}{0} â†’ {1}">
                                        <Binding Path="Origin"/>
                                        <Binding Path="Destination"/>
                                    </MultiBinding>
                                </DataGridTextColumn.Binding>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Ð’Ñ–Ð´Ð»Ñ–Ñ‚" 
                                              Binding="{Binding DepartureTime, StringFormat='{}{0:HH:mm}'}" 
                                              Width="80"/>
                            <DataGridTextColumn Header="ÐŸÑ€Ð¸Ð»Ñ–Ñ‚" 
                                              Binding="{Binding ArrivalTime, StringFormat='{}{0:HH:mm}'}" 
                                              Width="80"/>
                            <DataGridTemplateColumn Header="Ð¡Ñ‚Ð°Ñ‚ÑƒÑ" Width="80">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Border Background="{Binding Status, Converter={StaticResource FlightStatusToBrushConverter}}"
                                              CornerRadius="3"
                                              Padding="6,2">
                                            <TextBlock Text="{Binding Status}"
                                                     Foreground="White"
                                                     FontSize="10"
                                                     HorizontalAlignment="Center"/>
                                        </Border>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTextColumn Header="ÐŸÐ°ÑÐ°Ð¶Ð¸Ñ€Ð¸" 
                                              Binding="{Binding PassengerCount}" 
                                              Width="*"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </DockPanel>
            </Border>

            <Border Grid.Column="1" Margin="10,0,0,0">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="20">
                        <TextBlock Text="Ð”ÐµÑ‚Ð°Ð»Ñ– Ñ€ÐµÐ¹ÑÑƒ" 
                                 FontSize="18" 
                                 FontWeight="Medium" 
                                 Margin="0,0,0,15"/>
                        
                        <StackPanel Visibility="{Binding SelectedFlight, Converter={StaticResource NullToVisibilityConverter}}">
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                <Button Style="{StaticResource PrimaryButton}"
                                      Command="{Binding EditFlightCommand}"
                                      Margin="0,0,5,0">
                                    <TextBlock Text="âœ"/>
                                </Button>
                                
                                <Button Background="White" BorderBrush="Red" BorderThickness="1" Padding="12,8"
                                      Command="{Binding DeleteFlightCommand}"
                                      Foreground="Red">
                                    <TextBlock Text="ðŸ—‘"/>
                                </Button>
                            </StackPanel>
                            
                            <Separator Margin="0,0,0,15"/>
                            
                            <TextBlock>
                                <Run Text="ÐÐ¾Ð¼ÐµÑ€ Ñ€ÐµÐ¹ÑÑƒ:" FontWeight="Medium"/>
                                <Run Text="{Binding SelectedFlight.FlightNumber}"/>
                            </TextBlock>
                            
                            <TextBlock Margin="0,8,0,0">
                                <Run Text="Ð›Ñ–Ñ‚Ð°Ðº:" FontWeight="Medium"/>
                                <Run Text="{Binding SelectedFlight.Aircraft.RegistrationNumber}"/>
                                <Run Text="(" Foreground="Gray"/>
                                <Run Text="{Binding SelectedFlight.Aircraft.Model}" Foreground="Gray"/>
                                <Run Text=")" Foreground="Gray"/>
                            </TextBlock>
                            
                            <TextBlock Margin="0,8,0,0">
                                <Run Text="ÐœÐ°Ñ€ÑˆÑ€ÑƒÑ‚:" FontWeight="Medium"/>
                                <LineBreak/>
                                <Run Text="{Binding SelectedFlight.Origin}"/>
                                <Run Text="â†’"/>
                                <Run Text="{Binding SelectedFlight.Destination}"/>
                            </TextBlock>
                            
                            <TextBlock Margin="0,8,0,0">
                                <Run Text="Ð Ð¾Ð·ÐºÐ»Ð°Ð´:" FontWeight="Medium"/>
                                <LineBreak/>
                                <Run Text="Ð’Ñ–Ð´Ð»Ñ–Ñ‚: "/>
                                <Run Text="{Binding SelectedFlight.DepartureTime, StringFormat='{}{0:HH:mm}'}"/>
                                <LineBreak/>
                                <Run Text="ÐŸÑ€Ð¸Ð»Ñ–Ñ‚: "/>
                                <Run Text="{Binding SelectedFlight.ArrivalTime, StringFormat='{}{0:HH:mm}'}"/>
                            </TextBlock>
                            
                            <TextBlock Margin="0,8,0,0">
                                <Run Text="ÐŸÐ°ÑÐ°Ð¶Ð¸Ñ€Ð¸:" FontWeight="Medium"/>
                                <Run Text="{Binding SelectedFlight.PassengerCount}"/>
                                <Run Text="/"/>
                                <Run Text="{Binding SelectedFlight.Aircraft.PassengerCapacity}"/>
                            </TextBlock>
                            
                            <TextBlock Margin="0,8,0,0">
                                <Run Text="Ð’Ð°Ð½Ñ‚Ð°Ð¶:" FontWeight="Medium"/>
                                <Run Text="{Binding SelectedFlight.CargoWeight, StringFormat='{}{0:F1} kg'}"/>
                            </TextBlock>
                            
                            <TextBlock Margin="0,8,0,0">
                                <Run Text="ÐŸÐ°Ð»Ð¸Ð²Ð¾ (Ð¾Ñ€Ñ–Ñ”Ð½Ñ‚.):" FontWeight="Medium"/>
                                <Run Text="{Binding SelectedFlight.FuelConsumption, StringFormat='{}{0:F0} L'}"/>
                            </TextBlock>
                            
                            <TextBlock Margin="0,8,0,0"
                                     Visibility="{Binding SelectedFlight.Notes, Converter={StaticResource StringToVisibilityConverter}}">
                                <Run Text="ÐŸÑ€Ð¸Ð¼Ñ–Ñ‚ÐºÐ¸:" FontWeight="Medium"/>
                                <LineBreak/>
                                <Run Text="{Binding SelectedFlight.Notes}"/>
                            </TextBlock>
                        </StackPanel>
                        
                        <TextBlock Text="ÐžÐ±ÐµÑ€Ñ–Ñ‚ÑŒ Ñ€ÐµÐ¹Ñ Ð´Ð»Ñ Ð¿ÐµÑ€ÐµÐ³Ð»ÑÐ´Ñƒ Ð´ÐµÑ‚Ð°Ð»ÐµÐ¹" 
                                 Visibility="{Binding SelectedFlight, Converter={StaticResource NullToVisibilityConverter}, ConverterParameter=Invert}"
                                 Foreground="Gray"
                                 HorizontalAlignment="Center"
                                 VerticalAlignment="Center"/>
                    </StackPanel>
                </ScrollViewer>
            </Border>
        </Grid>
    </Grid>
</UserControl>